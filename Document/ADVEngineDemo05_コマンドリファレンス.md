- # ADVEngineDemo コマンドリファレンス

  最終更新: 2026/01/20

  対象バージョン: Current Build

  ------

  ## 1. キャラクター演出

  キャラクターの立ち絵表示・非表示を制御するコマンド群です。

  ### `@chara`

  キャラクターを表示、または表示中のキャラクターの状態（表情・位置など）を変更します。

  **書式**

  Plaintext

  ```
  @chara [ID] [表情] (パラメータ...)
  ```

  **パラメータ一覧**

  | **パラメータ** | **必須** | **型** | **デフォルト** | **説明**                                                     |
  | -------------- | -------- | ------ | -------------- | ------------------------------------------------------------ |
  | **ID**         | ✅        | String | -              | キャラクターの管理ID（`characters`辞書のキー）。             |
  | **表情**       | ✅        | String | -              | 表示する表情名（`normal`, `smile` 等）。                     |
  | **pos**        |          | String | auto           | 表示位置。`auto` (画面中央) または `x,y` (座標指定)。        |
  | **time**       |          | Int    | 1000           | フェードにかける時間（ミリ秒）。0で即時表示。                |
  | **wait**       |          | Bool   | true           | フェード完了を待つかどうか。`true`/`false`。                 |
  | **scale**      |          | Float  | 1.0            | 拡大縮小率。`1.0`が等倍。                                    |
  | **reflect**    |          | Bool   | false          | 左右反転するか。`true`で反転。                               |
  | **layer**      |          | Int    | 1              | 重なり順。数値が大きいほど手前に表示。                       |
  | **src**        |          | String | (IDと同じ)     | **クローン用**。データの読み込み元ID。指定しない場合は[ID]と同じデータを読み込む。 |

  **記述例**

  Plaintext

  ```
  # 基本: 画面中央に1秒かけてフェードイン
  @chara ai normal
  
  # 座標指定: 左寄り(x=500, y=900)に0.5秒で表示
  @chara ai smile pos:500,900 time=500
  
  # 同時表示: 完了待ちをせず(wait=false)に次へ進む
  @chara ai normal pos:400,900 wait=false
  @chara alice smile pos:1400,900 wait=true
  
  # クローン表示: データは"ai"を使い、別キャラ"ai_clone"として表示
  @chara ai_clone angry src=ai pos:1000,900 scale=0.8
  ```

  ------

  ### `@chara_hide`

  キャラクターを非表示にします。

  **書式**

  Plaintext

  ```
  @chara_hide [ID]
  ```

  **パラメータ一覧**

  | **パラメータ** | **必須** | **説明**                           |
  | -------------- | -------- | ---------------------------------- |
  | **ID**         | ✅        | 非表示にするキャラクターの管理ID。 |

  **記述例**

  Plaintext

  ```
  # aiを消す
  @chara_hide ai
  ```

  ------

  ## 2. 背景・ウインドウ

  ### `@bg`

  背景画像を変更します。

  **書式**

  Plaintext

  ```
  @bg [画像名]
  ```

  **パラメータ一覧**

  | **パラメータ** | **必須** | **説明**                                                     |
  | -------------- | -------- | ------------------------------------------------------------ |
  | **画像名**     | ✅        | `resources/backgrounds/` 内の画像ファイル名（拡張子なしでOK）。 |

  **記述例**

  Plaintext

  ```
  # room.png を表示
  @bg room
  ```

  ------

  ### `@window`

  メッセージウインドウを切り替えます。

  **書式**

  Plaintext

  ```
  @window [ウインドウID]
  ```

  **パラメータ一覧**

  | **パラメータ**   | **必須** | **説明**                                                     |
  | ---------------- | -------- | ------------------------------------------------------------ |
  | **ウインドウID** | ✅        | `window_config.json` に定義されたID（例: `default`, `narrator`）。 |

  **記述例**

  Plaintext

  ```
  # ナレーションモードへ
  @window narrator
  静寂が辺りを包んでいた……。
  
  # 通常会話モードへ戻す
  @window default
  ai: 戻りましたね。
  ```

  ------

  ## 3. 進行制御・待機

  ### `@wait`

  指定した時間だけシナリオの進行を停止します。

  **書式**

  Plaintext

  ```
  @wait time=[ミリ秒]
  ```

  **パラメータ一覧**

  | **パラメータ** | **必須** | **説明**                 |
  | -------------- | -------- | ------------------------ |
  | **time**       | ✅        | 待機する時間（ミリ秒）。 |

  **記述例**

  Plaintext

  ```
  # 2秒待つ
  @wait time=2000
  ```

  ### `@wait_cancel`

  現在実行中のウェイトを強制的にキャンセルし、即座に次の行へ進みます。

  （主にイベントスキップやジャンプ時の内部処理で使用されますが、演出として使うことも可能です）

  **書式**

  Plaintext

  ```
  @wait_cancel
  ```

  ------

  ## 4. シナリオ分岐・ジャンプ

  ### `@jump`

  指定したシナリオファイル、またはラベルへ移動します。**元の場所には戻りません。**

  **書式**

  Plaintext

  ```
  @jump [ターゲット]
  ```

  **パラメータ一覧**

  | **パラメータ** | **必須** | **説明**                                                     |
  | -------------- | -------- | ------------------------------------------------------------ |
  | **ターゲット** | ✅        | 移動先。以下の3パターンで指定可能。 1. `FileName` (別ファイルの先頭へ) 2. `.LabelName` (現在のファイルの指定ラベルへ) 3. `FileName.LabelName` (別ファイルの指定ラベルへ) |

  **記述例**

  Plaintext

  ```
  # 同じファイル内のラベル #BadEnd へ飛ぶ
  @jump .BadEnd
  
  # chapter2.txt の先頭へ飛ぶ
  @jump chapter2
  
  # chapter3.txt の #Scene5 へ飛ぶ
  @jump chapter3.Scene5
  ```

  ------

  ### `@call`

  現在の場所を記憶し、サブルーチンへ移動します。`@return` で戻ってこれます。

  **書式**

  Plaintext

  ```
  @call [ターゲット]
  ```

  **パラメータ一覧**

  | **パラメータ** | **必須** | **説明**                            |
  | -------------- | -------- | ----------------------------------- |
  | **ターゲット** | ✅        | 移動先。指定方法は `@jump` と同じ。 |

  **記述例**

  Plaintext

  ```
  # 共通演出処理を呼び出す
  @call .common_event_A
  ```

  ### `@return`

  `@call` で呼び出された先から、元の場所（呼び出し元の次の行）へ戻ります。

  **書式**

  Plaintext

  ```
  @return
  ```

  ------

  ## 5. オーディオ

  ### `@bgm`

  BGMを再生します。すでに再生中の場合はクロスフェードします。

  **書式**

  Plaintext

  ```
  @bgm [ファイル名] (パラメータ...)
  ```

  **パラメータ一覧**

  | **パラメータ**  | **必須** | **型** | **デフォルト** | **説明**                                |
  | --------------- | -------- | ------ | -------------- | --------------------------------------- |
  | **ファイル名**  | ✅        | String | -              | `resources/audio/bgm/` 内のファイル名。 |
  | **volume**      |          | Int    | 100            | 音量 (0-100)。                          |
  | **loop**        |          | Bool   | true           | ループ再生するか。                      |
  | **seek**        |          | Float  | 0.0            | 再生開始位置（秒）。                    |
  | **sprite_time** |          | String | ""             | ループ区間指定用（例: `1000-5000`）。   |

  **記述例**

  Plaintext

  ```
  # 基本再生
  @bgm peaceful_day
  
  # 音量小さめで再生
  @bgm tension volume=50
  ```

  ------

  ### `@stopbgm`

  BGMをフェードアウトして停止します。

  **書式**

  Plaintext

  ```
  @stopbgm (time=[秒数])
  ```

  **記述例**

  Plaintext

  ```
  # 2秒かけてフェードアウト
  @stopbgm time=2.0
  ```

  ------

  ### `@stopse`

  SE（効果音）を停止します。

  **書式**

  Plaintext

  ```
  @stopse (file=[ファイル名]) (time=[秒数])
  ```

  **記述例**

  Plaintext

  ```
  # 全てのSEを即座に停止
  @stopse
  
  # "rain" というSEだけを1秒かけて停止
  @stopse file=rain time=1.0
  ```

  ------

  ## 6. 基本会話テキスト

  コマンド以外の行は、会話テキストとして処理されます。

  **書式**

  Plaintext

  ```
  [名前]: [本文]
  ```

  **記述例**

  Plaintext

  ```
  # 名前あり
  ai: こんにちは！
  
  # 名前なし（地の文）
  : どこからか声が聞こえる……。
  
  # 演出タグの使用（RichTextLabel機能）
  ai: [color=red]危ない！[/color] [wave]逃げて！[/wave]
  ```
